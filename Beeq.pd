#N canvas 555 124 435 270 10;
#N canvas 782 494 409 294 manta_interface 0;
#X obj 207 149 route pad;
#X obj 166 111 manta;
#X obj 34 156 route pad button;
#N canvas 206 411 567 283 handle_buttons 0;
#X obj 107 26 inlet;
#X obj 107 106 select 0 1 2 3;
#X obj 107 53 unpack f f;
#X obj 107 79 spigot;
#X text 158 82 send the button id through on note-on;
#X text 88 206 sends 1 to select triplet sequence;
#X obj 107 162 tgl 15 0 empty empty empty 17 7 0 10 -262144 -1 -1 0
1;
#X obj 107 186 s \$0-sequence_type_triplet;
#X obj 127 129 tgl 15 0 empty empty empty 17 7 0 10 -262144 -1 -1 0
1;
#X obj 127 153 s \$0-step_enable;
#X connect 0 0 2 0;
#X connect 1 0 6 0;
#X connect 1 1 8 0;
#X connect 2 0 3 0;
#X connect 2 1 3 1;
#X connect 3 0 1 0;
#X connect 6 0 7 0;
#X connect 8 0 9 0;
#X restore 80 186 pd handle_buttons;
#N canvas 0 0 450 300 manta_init 0;
#X obj 134 100 outlet;
#X msg 134 72 ledcontrol padandbutton 1;
#X obj 134 44 loadbang;
#X msg 324 72 connect;
#X obj 303 38 t b b;
#X obj 301 8 bng 15 250 50 0 empty empty empty 17 7 0 10 -262144 -1
-1;
#X connect 1 0 0 0;
#X connect 2 0 1 0;
#X connect 3 0 0 0;
#X connect 4 0 1 0;
#X connect 4 1 3 0;
#X connect 5 0 4 0;
#X restore 141 23 pd manta_init;
#N canvas 312 235 1014 262 led_control 0;
#X obj 684 205 outlet;
#X obj 405 49 + 1;
#X msg 405 74 button \$1 0;
#N canvas 73 66 448 475 step_led 0;
#X obj 123 57 r \$0-triplet_step;
#X obj 116 35 r \$0-duplet_step;
#X obj 116 111 mux;
#X obj 159 332 outlet;
#X obj 189 269 f 0;
#X obj 116 162 t f f b;
#X obj 161 80 r \$0-sequence_type_triplet;
#X obj 71 255 pack f f;
#X obj 116 207 r \$0-sequence_type_triplet;
#X obj 116 231 + 1;
#X msg 71 276 pad \$2 \$1;
#X text 27 229 select color;
#N canvas 159 253 584 465 reset_step_led 0;
#X obj 53 35 inlet;
#X obj 53 388 outlet;
#X obj 53 339 pack f f;
#X obj 53 60 t f f;
#X msg 53 363 pad \$2 \$1;
#X obj 80 86 pad2step;
#X obj 213 43 r \$0-sequence_type_triplet;
#X obj 98 227 tabread;
#X obj 111 140 tableselector;
#X obj 98 249 != 0;
#X obj 98 311 * 1;
#X obj 213 148 == 0;
#X obj 213 170 + 1;
#X text 206 213 If the value stored in a given sequencer slot is zero
\, clear the LED. If the value is nonzero \, set the LED to yellow
if we're displaying a triplet sequence \, and red if we're displaying
a duplet sequence;
#X connect 0 0 3 0;
#X connect 2 0 4 0;
#X connect 3 0 2 0;
#X connect 3 1 5 0;
#X connect 4 0 1 0;
#X connect 5 0 7 0;
#X connect 6 0 5 1;
#X connect 6 0 8 0;
#X connect 6 0 11 0;
#X connect 7 0 9 0;
#X connect 8 1 7 0;
#X connect 9 0 10 0;
#X connect 10 0 2 1;
#X connect 11 0 12 0;
#X connect 12 0 10 1;
#X restore 189 293 pd reset_step_led;
#X obj 116 137 step2pad;
#X connect 0 0 2 1;
#X connect 1 0 2 0;
#X connect 2 0 13 0;
#X connect 4 0 12 0;
#X connect 5 0 7 0;
#X connect 5 1 4 1;
#X connect 5 2 4 0;
#X connect 6 0 2 2;
#X connect 6 0 13 1;
#X connect 7 0 10 0;
#X connect 8 0 9 0;
#X connect 9 0 7 1;
#X connect 10 0 3 0;
#X connect 12 0 3 0;
#X connect 13 0 5 0;
#X restore 404 116 pd step_led;
#X obj 405 24 r \$0-sequence_type_triplet;
#X text 152 54 handle the sequence type indicator LED;
#X text 71 115 light up the correct pad for the current sequence step
;
#X text 182 164 light up a pad as notes are played;
#N canvas 267 250 385 273 note_led 0;
#X obj 107 199 outlet;
#X obj 107 23 r \$0-note;
#X obj 107 52 unpack f f;
#X text 174 49 note \, velocity;
#X obj 164 74 == 0;
#X obj 164 96 select 1 0;
#X obj 107 91 + 16;
#X text -39 88 notes start in 3rd row;
#X msg 107 176 pad \$2 \$1;
#X obj 107 154 pack f f;
#X obj 164 121 f 0;
#X obj 192 121 f 1;
#X connect 1 0 2 0;
#X connect 2 0 6 0;
#X connect 2 1 4 0;
#X connect 4 0 5 0;
#X connect 5 0 10 0;
#X connect 5 1 11 0;
#X connect 6 0 9 0;
#X connect 8 0 0 0;
#X connect 9 0 8 0;
#X connect 10 0 9 1;
#X connect 11 0 9 1;
#X restore 403 165 pd note_led;
#X obj 614 20 r \$0-step_enable;
#X obj 636 42 r \$0-step;
#X obj 636 65 tgl 15 0 empty empty empty 17 7 0 10 -262144 -1 -1 0
1;
#X msg 636 85 button \$1 1;
#X text 665 62 blink button 1 when running;
#X connect 1 0 2 0;
#X connect 2 0 0 0;
#X connect 3 0 0 0;
#X connect 4 0 1 0;
#X connect 8 0 0 0;
#X connect 9 0 11 0;
#X connect 10 0 11 0;
#X connect 11 0 12 0;
#X connect 12 0 0 0;
#X restore 179 56 pd led_control;
#N canvas 238 127 574 441 handle_pad_velocity 0;
#X obj 73 40 inlet;
#X obj 73 96 moses 16;
#X obj 254 367 s \$0-step_select;
#X obj 254 346 pack f f;
#X obj 118 260 r \$0-sequence_type_triplet;
#X obj 73 285 pad2step;
#X obj 299 119 != 0;
#X obj 180 121 r \$0-step_select;
#X obj 180 144 unpack f f;
#X obj 180 171 == 0;
#X text 191 199 only allow notes through if we don't have a step selected
;
#X obj 96 145 - 16;
#X obj 73 70 unpack f f;
#X obj 96 172 pack f f;
#X obj 135 224 s \$0-note;
#X obj 135 201 spigot 1;
#X obj 143 115 != 0;
#X obj 141 146 * 150;
#X connect 0 0 12 0;
#X connect 1 0 5 0;
#X connect 1 1 11 0;
#X connect 3 0 2 0;
#X connect 4 0 5 1;
#X connect 5 0 3 0;
#X connect 6 0 3 1;
#X connect 7 0 8 0;
#X connect 8 1 9 0;
#X connect 9 0 15 1;
#X connect 11 0 13 0;
#X connect 12 0 1 0;
#X connect 12 1 6 0;
#X connect 12 1 16 0;
#X connect 13 0 15 0;
#X connect 15 0 14 0;
#X connect 16 0 17 0;
#X connect 17 0 13 1;
#X restore 34 209 pd handle_pad_velocity;
#N canvas 265 111 496 338 handle_pad_continuous 0;
#X obj 147 13 inlet;
#X obj 147 39 unpack f f;
#X obj 147 126 - 16;
#X obj 147 226 s \$0-pad_continuous;
#X text 8 126 note pads start at 16;
#X obj 139 80 moses 16;
#X obj 147 149 manta.poly;
#X obj 147 174 pack f f f;
#X obj 147 197 route 0;
#X text 223 167 limit one pad pressed at a time \, for now;
#X connect 0 0 1 0;
#X connect 1 0 5 0;
#X connect 1 1 6 1;
#X connect 2 0 6 0;
#X connect 5 1 2 0;
#X connect 6 0 7 0;
#X connect 6 1 7 1;
#X connect 6 2 7 2;
#X connect 7 0 8 0;
#X connect 8 0 3 0;
#X restore 207 175 pd handle_pad_continuous;
#X connect 0 0 7 0;
#X connect 1 0 2 0;
#X connect 1 1 0 0;
#X connect 2 0 6 0;
#X connect 2 1 3 0;
#X connect 4 0 1 0;
#X connect 5 0 1 0;
#X restore 33 59 pd manta_interface;
#N canvas 97 77 414 374 step_counter 0;
#X obj 23 207 f 0;
#X obj 51 206 mod 3;
#X obj 52 184 + 1;
#X obj 23 233 select 0;
#X obj 116 204 f 0;
#X obj 145 181 + 1;
#X obj 116 230 select 0;
#X obj 144 203 mod 4;
#X text 165 42 incoming BPM is for duplet time;
#X obj 123 45 inlet;
#X obj 72 111 metro 100;
#X obj 123 89 /;
#X obj 23 279 f 0;
#X obj 51 256 + 1;
#X obj 116 279 f 0;
#X obj 144 256 + 1;
#X obj 51 278 mod 16;
#X obj 144 278 mod 12;
#X msg 123 67 10000 \$1;
#X obj 23 330 s \$0-duplet_step;
#X obj 116 305 s \$0-triplet_step;
#X obj 72 133 t b b b;
#X obj 207 183 s \$0-step;
#X obj 72 14 r \$0-step_enable;
#X connect 0 0 2 0;
#X connect 0 0 3 0;
#X connect 1 0 0 1;
#X connect 2 0 1 0;
#X connect 3 0 12 0;
#X connect 4 0 5 0;
#X connect 4 0 6 0;
#X connect 5 0 7 0;
#X connect 6 0 14 0;
#X connect 7 0 4 1;
#X connect 9 0 18 0;
#X connect 10 0 21 0;
#X connect 11 0 10 1;
#X connect 12 0 13 0;
#X connect 12 0 19 0;
#X connect 13 0 16 0;
#X connect 14 0 15 0;
#X connect 14 0 20 0;
#X connect 15 0 17 0;
#X connect 16 0 12 1;
#X connect 17 0 14 1;
#X connect 18 0 11 0;
#X connect 21 0 0 0;
#X connect 21 1 4 0;
#X connect 21 2 22 0;
#X connect 23 0 10 0;
#X restore 202 72 pd step_counter;
#N canvas 32 555 465 378 sequences 0;
#N canvas 0 0 450 300 (subpatch) 0;
#X array duplet01_note 16 float 2;
#X coords 0 32 16 0 200 140 1;
#X restore 12 28 graph;
#N canvas 0 0 450 300 (subpatch) 0;
#X array duplet01_value 16 float 2;
#X coords 0 256 16 0 200 140 1;
#X restore 13 190 graph;
#N canvas 0 0 450 300 (subpatch) 0;
#X array triplet01_note 12 float 2;
#X coords 0 32 12 0 200 140 1;
#X restore 225 29 graph;
#N canvas 0 0 450 300 (subpatch) 0;
#X array triplet01_value 12 float 2;
#X coords 0 256 12 0 200 140 1;
#X restore 226 192 graph;
#X restore 33 87 pd sequences;
#N canvas 0 0 533 436 sequence_record 0;
#X obj 191 35 r \$0-step_select;
#X obj 191 59 unpack f f;
#X text 261 57 step number \, selected (0 or 1);
#X obj 277 105 r \$0-pad_continuous;
#X obj 146 317 tabwrite;
#X obj 334 317 tabwrite;
#X obj 277 129 spigot;
#X text 137 335 note table;
#X text 322 334 value table;
#X obj 277 153 unpack f f;
#X text 345 172 note number \, value;
#X obj 16 221 r \$0-sequence_type_triplet;
#X obj 16 244 tableselector;
#X connect 0 0 1 0;
#X connect 1 0 4 1;
#X connect 1 0 5 1;
#X connect 1 1 6 1;
#X connect 3 0 6 0;
#X connect 6 0 9 0;
#X connect 9 0 4 0;
#X connect 9 1 5 0;
#X connect 11 0 12 0;
#X connect 12 0 4 0;
#X connect 12 1 5 0;
#X restore 33 115 pd sequence_record;
#N canvas 263 38 415 425 sequence_play 0;
#X obj 178 28 r \$0-duplet_step;
#X obj 178 227 r \$0-triplet_step;
#X obj 60 80 tabread duplet01_note;
#X obj 205 80 tabread duplet01_value;
#X obj 178 54 t f f;
#X obj 165 178 s \$0-note;
#X obj 178 252 t f f;
#X obj 165 379 s \$0-note;
#X obj 60 280 tabread triplet01_note;
#X obj 205 280 tabread triplet01_value;
#X obj 60 303 int;
#X obj 60 102 int;
#X obj 165 334 makenote 0 100;
#X obj 165 131 makenote 0 100;
#X obj 165 358 pack f f;
#X obj 165 156 pack f f;
#X obj 311 105 inlet;
#X connect 0 0 4 0;
#X connect 1 0 6 0;
#X connect 2 0 11 0;
#X connect 3 0 13 1;
#X connect 4 0 2 0;
#X connect 4 1 3 0;
#X connect 6 0 8 0;
#X connect 6 1 9 0;
#X connect 8 0 10 0;
#X connect 9 0 12 1;
#X connect 10 0 12 0;
#X connect 11 0 13 0;
#X connect 12 0 14 0;
#X connect 12 1 14 1;
#X connect 13 0 15 0;
#X connect 13 1 15 1;
#X connect 14 0 7 0;
#X connect 15 0 5 0;
#X connect 16 0 13 2;
#X connect 16 0 12 2;
#X restore 203 143 pd sequence_play;
#X floatatom 202 48 5 0 0 2 BPM - -;
#N canvas 492 185 307 171 init 0;
#X obj 58 74 s \$0-sequence_type_triplet;
#X obj 58 30 loadbang;
#X obj 58 52 f 0;
#X connect 1 0 2 0;
#X connect 2 0 0 0;
#X restore 33 31 pd init;
#X floatatom 203 115 5 0 0 2 Note_Length - -;
#N canvas 0 0 317 280 note_handler 0;
#X obj 113 87 r \$0-note;
#X obj 113 144 PadMap;
#X obj 56 36 loadbang;
#X msg 56 59 read Wicki-Hayden.map;
#X obj 113 167 + 40;
#X obj 113 112 unpack f f;
#X text 186 111 note \, value;
#X obj 145 199 noteout 1;
#X connect 0 0 5 0;
#X connect 1 0 4 0;
#X connect 2 0 3 0;
#X connect 3 0 1 0;
#X connect 4 0 7 0;
#X connect 5 0 1 0;
#X connect 5 1 7 1;
#X restore 34 144 pd note_handler;
#X connect 5 0 1 0;
#X connect 7 0 4 0;
